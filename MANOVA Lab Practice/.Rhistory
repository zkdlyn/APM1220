knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(tidyverse)
library(readr)
library(MVN)
library(mice)
library(heplots)
})
df <- read_csv("manova_mancova_practice.csv", show_col_types = FALSE)
head(df)
df <- df %>%
select(-"ID") %>%
mutate(across(c("Treatment", "Gender", "School"), as.factor))
df <- df %>%
select(-"ID") %>%
mutate(across(c("Treatment", "Gender", "School"), as.factor))
colSums(is.na(df))
# df_imputed <- kNN(df, k = 5, imp_var = FALSE)
df_imputed <- df %>%
mutate(
SES_Index = ifelse(is.na(SES_Index), mean(SES_Index, na.rm=TRUE), SES_Index),
Pre_Math = ifelse(is.na(Pre_Math), mean(Pre_Math, na.rm=TRUE), Pre_Math),
Pre_Reading = ifelse(is.na(Pre_Reading), mean(Pre_Reading, na.rm=TRUE), Pre_Reading),
Pre_Science = ifelse(is.na(Pre_Science), mean(Pre_Science, na.rm=TRUE), Pre_Science),
Post_Math = ifelse(is.na(Post_Math), mean(Post_Math, na.rm=TRUE), Post_Math),
Post_Reading = ifelse(is.na(Post_Reading), mean(Post_Reading, na.rm=TRUE), Post_Reading),
Post_Science = ifelse(is.na(Post_Science), mean(Post_Science, na.rm=TRUE), Post_Science),
)
colSums(is.na(df_imputed))
round(data.frame(mean = sapply(select(df,where(is.numeric)), mean, na.rm=TRUE),
mean_imp = sapply(select(df_imputed,where(is.numeric)), mean),
var = sapply(select(df,where(is.numeric)), var, , na.rm=TRUE),
var_imp = sapply(select(df_imputed,where(is.numeric)), var)),4)
lapply(select(df_imputed,where(is.numeric)), function(x) boxplot.stats(x)$out)
dvs <-df_imputed[,9:11]
dvs$dist <- mahalanobis(dvs, colMeans(dvs), cov(dvs))
threshold <- qchisq(1 - 0.001, df = 3)
outliers <- dvs[dvs$dist > threshold,]
outliers
boxplot(df_imputed)
boxplot(df_imputed)
lapply(select(df_imputed,where(is.numeric)), function(x) boxplot.stats(x)$out)
dvs <-df_imputed[,9:11]
dvs$dist <- mahalanobis(dvs, colMeans(dvs), cov(dvs))
threshold <- qchisq(1 - 0.001, df = 3)
outliers <- dvs[dvs$dist > threshold,]
outliers
df_no_outliers <- df_imputed[-114,]
manova_result <- manova(
cbind(Post_Math, Post_Reading, Post_Science) ~ Treatment,
data = df_no_outliers
)
summary(manova_result)
wilks <- summary(manova_result, test ="Wilks")
pillai <- summary(manova_result, test ="Pillai")
roy <- summary(manova_result, test ="Roy")
lh<- summary(manova_result, test ="Hotelling-Lawley")
data.frame( Wilks = wilks$stats[1,2],
Pillai = pillai$stats[1,2],
Lawley_Hotell = lh$stats[1,2],
Roy = roy$stats[1,2])
boxplot(df_no_outliers$Treatment)
plot(df_no_outliers$Treatment)
manova_result <- manova(
cbind(Post_Math, Post_Reading, Post_Science) ~ Treatment,
data = df_no_outliers
)
summary(manova_result)
wilks <- summary(manova_result, test ="Wilks")
pillai <- summary(manova_result, test ="Pillai")
roy <- summary(manova_result, test ="Roy")
lh<- summary(manova_result, test ="Hotelling-Lawley")
data.frame( Wilks = wilks$stats[1,2],
Pillai = pillai$stats[1,2],
Lawley_Hotell = lh$stats[1,2],
Roy = roy$stats[1,2])
summary.aov(manova_result)
boxM(cbind(Post_Math, Post_Reading, Post_Science) ~ Treatment,
data = df_no_outliers)
multivariate_diagnostic_plot(df_no_outliers[,9:11], type="qq")
manova_2w_result <- manova(cbind(Post_Math, Post_Reading, Post_Science) ~
Treatment * School, data = df_no_outliers)
summary(manova_result, test = "Wilks")
summary.aov(manova_result)
wilks2 <- summary(manova_2w_result, test ="Wilks")
pillai2 <- summary(manova_2w_result, test ="Pillai")
roy2 <- summary(manova_2w_result, test ="Roy")
lh2<- summary(manova_2w_result, test ="Hotelling-Lawley")
data.frame( Wilks = wilks2$stats[1,2],
Pillai = pillai2$stats[1,2],
Lawley_Hotell = lh2$stats[1,2],
Roy = roy2$stats[1,2])
manova_2w_result <- manova(cbind(Post_Math, Post_Reading, Post_Science) ~
Treatment * School, data = df_no_outliers)
summary(manova_2w_result, test = "Wilks")
summary.aov(manova_2w_result)
manova_2w_result <- manova(cbind(Post_Math, Post_Reading, Post_Science) ~
Treatment * School, data = df_no_outliers)
summary(manova_2w_result)
summary.aov(manova_2w_result)
