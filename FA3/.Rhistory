knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(tidyverse)
library(readxl)
library(ggplot2)
library(dplyr)
library(MVN)
library(MASS)
})
df1 <- suppressMessages(read_excel("Flea Beetles.xlsx",skip=1))
beetle1 <- df1[-20, 2:5]
beetle2 <- df1[, 7:10]
names(beetle1) <- c("Y1","Y2","Y3","Y4")
names(beetle2) <- c("Y1","Y2","Y3","Y4")
beetle1$Species <- "H. oleracea"
beetle2$Species <- "H. carduorum"
beetles<- bind_rows(beetle1, beetle2)
beetles
beetle1.mean <- colMeans(beetle1[, 1:4])
beetle2.mean <- colMeans(beetle2[, 1:4])
n1 <- nrow(beetle1)
n2 <- nrow(beetle2)
w1 <- (n1 - 1) * var(beetle1[, 1:4])
w2 <- (n2 - 1) * var(beetle2[, 1:4])
sp1 <- 1 / (n1 + n2 - 2) * (w1 + w2)
a <- solve(sp1) %*% (beetle1.mean - beetle2.mean)
a
diag(sp1)^(1/2) * a
beet.lda <- lda(Species ~ ., data = beetles)
beet.lda$scaling /a
df2 <- suppressMessages(read_excel("Scores on Fish.xlsx",skip=2))
method1 <- df2[, 1:4]
method2 <- df2[, 5:8]
method3 <- df2[, 9:12]
names(method1) <- c("Y1","Y2","Y3","Y4")
names(method2) <- c("Y1","Y2","Y3","Y4")
names(method3) <- c("Y1","Y2","Y3","Y4")
method1$Method <- 1
method2$Method <- 2
method3$Method <- 3
fish <- bind_rows(method1, method2,method3)
fish$Method <- factor(tidy_fish$Method)
fish
method1.e <- eigen(method1[-5])
beet.lda$scaling
beet.lda <- lda(Species ~ ., data = beetles)
beet.lda$scaling
sp1 <- 1 / (n1 + n2 - 2) * (w1 + w2)
S1 <- cov(beetle1)
S1 <- cov(beetle1[, 1:4])
S2 <- cov(beetle2[, 1:4])
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(tidyverse)
library(readxl)
library(ggplot2)
library(dplyr)
library(MVN)
library(MASS)
})
df1 <- suppressMessages(read_excel("Flea Beetles.xlsx",skip=1))
beetle1 <- df1[-20, 2:5]
beetle2 <- df1[, 7:10]
names(beetle1) <- c("Y1","Y2","Y3","Y4")
names(beetle2) <- c("Y1","Y2","Y3","Y4")
beetle1$Species <- "H. oleracea"
beetle2$Species <- "H. carduorum"
beetles<- bind_rows(beetle1, beetle2)
beetles
xbar1 <- colMeans(beetle1[, 1:4])
xbar2 <- colMeans(beetle2[, 1:4])
S1 <- cov(beetle1[, 1:4])
S2 <- cov(beetle2[, 1:4])
n1 <- nrow(beetle1)
n2 <- nrow(beetle2)
Sp <- ((n1 - 1) * S1 + (n2 - 1) * S2) / (n1 + n2 - 2)
a <- solve(Sp, xbar1 - xbar2)
a
diag(sp1)^(1/2) * a
a / (sqrt(diag(Sp)))
beet.lda <- lda(Species ~ ., data = beetles)
beet.lda$scaling
a <- solve(Sp, xbar1 - xbar2)
a
solve(sp1) %*% (beetle1.mean - beetle2.mean)
a <- solve(Sp, xbar1 - xbar2)
a
w1 <- (n1 - 1) * var(beetle1[, 1:4])
w2 <- (n2 - 1) * var(beetle2[, 1:4])
sp1 <- 1 / (n1 + n2 - 2) * (w1 + w2)
a <- solve(sp1) %*% (beetle1.mean - beetle2.mean)
a
a <- solve(Sp, xbar1 - xbar2)
a
# a / (sqrt(diag(Sp)))
pooled_sd <- sqrt(diag(Sp))
# Standardized coefficients
a / pooled_sd
a / (sqrt(diag(Sp)))
beet.lda <- lda(Species ~ ., data = beetles)
beet.lda$scaling
beet.lda$scaling/a
beet.lda$scaling*a
diff <- xbar1 - xbar2
T2 <- (n1*n2) / (n1+n2) * t(diff) %*% solve(Sp) %*% diff
T2 <- as.numeric(T2)
T2
p=4
(n1+n2-p-1)*T2/(p*(n1+n2-2))
df1 <- p
df2 <- n1 + n2 - p - 1
F_stat <- (df2 * T2) / (df1 * (n1 + n2 - 2))
# Step 7: Compute p-value
p_value <- pf(F_stat, df1, df2, lower.tail = FALSE)
p_value <- pf(F_stat, df1, df2, lower.tail = FALSE)
cat("Hotelling's T-squared:", T2, "\n")
cat("F-statistic:", F_stat, "\n")
cat("Degrees of freedom:", df1, df2, "\n")
cat("p-value:", p_value, "\n")
(n1+n2-p-1)*T2/(p*(n1+n2-2))
p=4
df1 <- p
df2 <- n1 + n2 - p - 1
F_stat <- (df2*T2) / (df1*(n1+n2- 2))
p_value <- pf(F_stat, df1, df2, lower.tail = FALSE)
cat("Hotelling's T-squared:", T2, "\n")
cat("F-statistic:", F_stat, "\n")
cat("Degrees of freedom:", df1, df2, "\n")
cat("p-value:", p_value, "\n")
ncol(beetles)
diff <- xbar1 - xbar2
T2 <- (n1*n2) / (n1+n2) * t(diff) %*% solve(Sp) %*% diff
T2 <- as.numeric(T2)
p=ncol(beetles)-1
df1 <- p
df2 <- n1 + n2 - p - 1
F_stat <- (df2*T2) / (df1*(n1+n2- 2))
p_value <- pf(F_stat, df1, df2, lower.tail = FALSE)
cat("Hotelling's T-squared:", T2, "\n")
cat("F-statistic:", F_stat, "\n")
cat("Degrees of freedom:", df1, df2, "\n")
cat("p-value:", p_value, "\n")
diff <- xbar1 - xbar2
T2 <- (n1*n2) / (n1+n2) * t(diff) %*% solve(Sp) %*% diff
T2 <- as.numeric(T2)
p=ncol(beetles)-1
df1 <- p
df2 <- n1 + n2 - p - 1
F_stat <- (df2*T2) / (df1*(n1+n2- 2))
p_value <- pf(F_stat, df1, df2, lower.tail = FALSE)
cat("Hotelling's T-squared:", T2, "\n")
cat("F-statistic:", F_stat, "\n")
cat("Degrees of freedom:", df1, ",", df2, "\n")
cat("p-value:", p_value, "\n")
diff <- xbar1 - xbar2
T2 <- (n1*n2) / (n1+n2) * t(diff) %*% solve(Sp) %*% diff
T2 <- as.numeric(T2)
p=ncol(beetles)-1
df1 <- p
df2 <- n1 + n2 - p - 1
F_stat <- (df2*T2) / (df1*(n1+n2- 2))
p_val <- pf(F_stat, df1, df2, lower.tail = FALSE)
cat("Hotelling's T-squared:", T2, "\n")
cat("F-statistic:", F_stat, "\n")
cat("Degrees of freedom:", df1, ",", df2, "\n")
cat("p-value:", p_val, "\n")
data.frame(
T2 = T2,
F_stat = F_stat,
df1 = df1, df2 = df2,
p_val = p_val
)
diff <- xbar1 - xbar2
T2 <- (n1*n2) / (n1+n2) * t(diff) %*% solve(Sp) %*% diff
T2 <- as.numeric(T2)
p=ncol(beetles)-1
df1 <- p
df2 <- n1 + n2 - p - 1
F_stat <- (df2*T2) / (df1*(n1+n2- 2))
data.frame(
T2 = T2,
F_stat = F_stat,
df1 = df1, df2 = df2,
p_val = p_val
)
