---
title: "Formative Assessment 3"
author: "Baybayon, Darlyn Antoinette B."
output: pdf_document
header-includes:
  - \usepackage{titling}
  - \setlength{\droptitle}{-2cm}   % move title up
geometry: top=2cm, bottom=2cm, left=2cm, right=2cm
mainfont: "Georgia"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
suppressPackageStartupMessages({
  library(tidyverse)
  library(readxl)
  library(ggplot2)
  library(dplyr)
  library(MVN)
  library(MASS)
})
```

## Flea Beetles Dataset

```{r}
df1 <- suppressMessages(read_excel("Flea Beetles.xlsx",skip=1))
beetle1 <- df1[-20, 2:5]
beetle2 <- df1[, 7:10]
names(beetle1) <- c("Y1","Y2","Y3","Y4")
names(beetle2) <- c("Y1","Y2","Y3","Y4")
beetle1$Species <- "H. oleracea"
beetle2$Species <- "H. carduorum"

beetles<- bind_rows(beetle1, beetle2)
beetles
```

(a) **Find the discriminant function coefficient vector and test significance of separation.**

Compute group mean vectors
```{r}
xbar1 <- colMeans(beetle1[, 1:4])
xbar2 <- colMeans(beetle2[, 1:4])
```

Compute group covariance matrices
```{r}
S1 <- cov(beetle1[, 1:4])
S2 <- cov(beetle2[, 1:4])
```


Pooled within-group covariance matrix $S_p=\frac{(n_1-1)S_1+(n_2)S_2}{n_1+n_2-2}$

```{r}
n1 <- nrow(beetle1)
n2 <- nrow(beetle2)

Sp <- ((n1-1) * S1 + (n2-1) * S2) / (n1+n2-2)
```

Compute $a=S_p^{-1}(\bar{x_1}-\bar{x_2})$
```{r}
a <- solve(Sp, xbar1-xbar2) 
a
```
Hotelling's $T^2$
```{r}
diff <- xbar1 - xbar2

T2 <- (n1*n2) / (n1+n2) * t(diff) %*% solve(Sp) %*% diff
T2 <- as.numeric(T2)  
p=ncol(beetles)-1

df1 <- p
df2 <- n1 + n2 - p - 1

F_stat <- (df2*T2) / (df1*(n1+n2- 2))

data.frame(
  T2 = T2, 
  F_stat = F_stat,
  df1 = df1, df2 = df2,
  p_val = p_val
)
```
Convert to F statistic
```{r}

```



(b) **Find the standardized coefficients.**


```{r}
a / (sqrt(diag(Sp)))
```

Hence, we have the following discriminant function:

$$z=4.137y_1-2.5y_2-1.158y_3-2.068y_4$$

(c) **Calculate t-tests for individual variables.**

(d) **Compare the results of (b) and (c) as to the contribution of each variable to separation of the groups.**

(e) **Find the partial F for each variable. Do the partial Fâ€™s rank the variables in the same order of importance as the standardized coefficients?**

## Scores on Fish Dataset

```{r}
df2 <- suppressMessages(read_excel("Scores on Fish.xlsx",skip=2))
method1 <- df2[, 1:4]
method2 <- df2[, 5:8]
method3 <- df2[, 9:12]

names(method1) <- c("Y1","Y2","Y3","Y4")
names(method2) <- c("Y1","Y2","Y3","Y4")
names(method3) <- c("Y1","Y2","Y3","Y4")

method1$Method <- 1
method2$Method <- 2
method3$Method <- 3

fish <- bind_rows(method1, method2,method3)
fish$Method <- factor(tidy_fish$Method)
fish
```

(a) **Find the eigenvectors.**

```{r}
method1.e <- eigen(method1[-5])
method1
```





(b) **Carry out tests of significance for the discriminant functions and find the relative importance of each. Do these two procedures agree as to the number of important discriminant functions?**

(c) **Find the standardized coefficients and comment on the contribution of the variables to separation of groups.**

(d) **Find the partial F for each variable. Do they rank the variables in the same order as the standardized coefficients for the first discriminant function?**

(e) **Plot the first two discriminant functions for each observation and for the mean vectors.**

(f) **Carry out a stepwise selection of variables.**
