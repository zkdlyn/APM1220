---
title: "Formative Assessment 3"
author: "Baybayon, Darlyn Antoinette B."
output: pdf_document
header-includes:
  - \usepackage{titling}
  - \setlength{\droptitle}{-2cm}   % move title up
geometry: top=2cm, bottom=2cm, left=2cm, right=2cm
mainfont: "Georgia"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
suppressPackageStartupMessages({
  library(tidyverse)
  library(readxl)
  library(ggplot2)
  library(dplyr)
  library(MVN)
  library(MASS)
})
```

## Flea Beetles Dataset

```{r}
df1 <- suppressMessages(read_excel("Flea Beetles.xlsx",skip=1))
beetle1 <- df1[-20, 2:5]
beetle2 <- df1[, 7:10]
names(beetle1) <- c("Y1","Y2","Y3","Y4")
names(beetle2) <- c("Y1","Y2","Y3","Y4")
beetle1$Species <- "H. oleracea"
beetle2$Species <- "H. carduorum"

beetles<- bind_rows(beetle1, beetle2)
beetles
```

(a) **Find the discriminant function coefficient vector and test significance of separation.**

```{r}
beetle1.mean <- colMeans(beetle1[, 1:4])
beetle2.mean <- colMeans(beetle2[, 1:4])

```

```{r}
n1 <- nrow(beetle1)
n2 <- nrow(beetle2)
w1 <- (n1 - 1) * var(beetle1[, 1:4])
w2 <- (n2 - 1) * var(beetle2[, 1:4])

sp1 <- 1 / (n1 + n2 - 2) * (w1 + w2)

a <- solve(sp1) %*% (beetle1.mean - beetle2.mean)
a
```

(b) **Find the standardized coefficients.**

```{r}
diag(sp1)^(1/2) * a
```
Hence, we have the following discriminant function:

$$z=4.137y_1-2.5y_2-1.158y_3-2.068y_4$$


```{r}
beet.lda <- lda(Species ~ ., data = beetles)
beet.lda$scaling /a
```

(c) **Calculate t-tests for individual variables.**

(d) **Compare the results of (b) and (c) as to the contribution of each variable to separation of the groups.**

(e) **Find the partial F for each variable. Do the partial Fâ€™s rank the variables in the same order of importance as the standardized coefficients?**

## Scores on Fish Dataset

```{r}
df2 <- suppressMessages(read_excel("Scores on Fish.xlsx",skip=2))
method1 <- df2[, 1:4]
method2 <- df2[, 5:8]
method3 <- df2[, 9:12]

names(method1) <- c("Y1","Y2","Y3","Y4")
names(method2) <- c("Y1","Y2","Y3","Y4")
names(method3) <- c("Y1","Y2","Y3","Y4")

method1$Method <- 1
method2$Method <- 2
method3$Method <- 3

fish <- bind_rows(method1, method2,method3)
fish$Method <- factor(tidy_fish$Method)
fish
```

(a) **Find the eigenvectors.**

```{r}
method1.e <- eigen(method1[-5])
method1
```





(b) **Carry out tests of significance for the discriminant functions and find the relative importance of each. Do these two procedures agree as to the number of important discriminant functions?**

(c) **Find the standardized coefficients and comment on the contribution of the variables to separation of groups.**

(d) **Find the partial F for each variable. Do they rank the variables in the same order as the standardized coefficients for the first discriminant function?**

(e) **Plot the first two discriminant functions for each observation and for the mean vectors.**

(f) **Carry out a stepwise selection of variables.**
